<!DOCTYPE html>
<html>
  <head>
    <title>Minimal frontend for LessPass</title>
    <meta charset="UTF-8"/>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'unsafe-inline'; style-src 'unsafe-inline'">
    <meta http-equiv="X-Content-Security-Policy" content="default-src 'none'; script-src 'unsafe-inline; style-src 'unsafe-inline'">
    <meta http-equiv="X-WebKit-CSP" content="default-src 'none'; script-src 'unsafe-inline'; style-src 'unsafe-inline'">
    <meta name="viewport" content="width=device-with, initial-scale=1, maximum-scale=1">
    <style>
      form > div {
        margin: 3px;
      }

      form > div > label {
        display: inline-block;
        width: 200px;
      }
    </style>
  </head>
  <body>
    <form id="lp-form" autocomplete="off">
      <div>
        <label for="context">Context:</label>
        <input type="text" name="context"/>
      </div>

      <div>
        <label for="identifier">Identifier:</label>
        <input type="text" name="identifier" inputmode="email"/>
      </div>

      <div>
        <label for="masterpassword">Master password:</label>
        <input type="password" name="masterpassword" onkeyup="updateChecksum()"/>
      </div>

      <div>
        <label for="checksum">Checksum:</label><br />
        <span class="lp-mp-render"></span>
      </div>

      <div>
        <label for="number">Number:</label>
        <input type="number" name="number" value="1"/>
      </div>

      <div>
        <label for="length">Length:</label>
        <input type="number" name="length" value="32"/>
      </div>

      <div>
        <input type="checkbox" name="rules[]" value="uppercase" checked="checked">A-Z
        <input type="checkbox" name="rules[]" value="lowercase" checked="checked">a-z
        <input type="checkbox" name="rules[]" value="numbers" checked="checked">0-9
        <input type="checkbox" name="rules[]" value="symbols" checked="checked">@$!
      </div>

      <div>
        <input type="button" value="Generate (iOS)" onclick="generatePassword()">
        <input type="button" value="Generate &amp; Clipboard (non-iOS)" onclick="generateAndCopyPassword()">
      </div>

      <div>
        <label for="result">Result:</label>
        <input type="text" name="result" readonly="readonly"/>
      </div>

      <div>
        <input type="button" value="Clear" onclick="clearForm()"/>
        <input type="button" value="Clipboard &amp; Clear (iOS)" onclick="clipboardAndClear()"/>
      </div>

      <div style="color: gray; font-size: 8pt;">
          This program is free software: you can redistribute it and/or modify
          it under the terms of the GNU General Public License as published by
          the Free Software Foundation, either version 3 of the License, or
          (at your option) any later version.

          This program is distributed in the hope that it will be useful,
          but WITHOUT ANY WARRANTY; without even the implied warranty of
          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
          GNU General Public License for more details.

          You should have received a copy of the GNU General Public License
          along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>
      </div>
    </form>
  </body>
  <!-- 
    Minified source code of Lesspass Javascript libraries and dependencies.

    Lesspass JS libraries Copyright (C) 2020 the collaborators at lesspass.com

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>. 
  -->
  <script>!function t(e,r,n){function o(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(t){return o(e[s][1][t]||t)},f,f.exports,t,e,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,r){window.lesspass=t("../node_modules/lesspass/index.js")},{"../node_modules/lesspass/index.js":12}],2:[function(t,e,r){var n=function(t){"use strict";var e=1e7,r=7,o=9007199254740992,i=l(o),s=Math.log(o);function a(t,e){return void 0===t?a[0]:void 0!==e?10==+e?J(t):U(t,e):J(t)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function p(t){this.value=t,this.sign=t<0,this.isSmall=!0}function f(t){return-o<t&&t<o}function l(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function c(t){h(t);var r=t.length;if(r<4&&O(t,i)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function h(t){for(var e=t.length;0===t[--e];);t.length=e+1}function v(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function y(t){return t>0?Math.floor(t):Math.ceil(t)}function g(t,r){var n,o,i=t.length,s=r.length,a=new Array(i),u=0,p=e;for(o=0;o<s;o++)u=(n=t[o]+r[o]+u)>=p?1:0,a[o]=n-u*p;for(;o<i;)u=(n=t[o]+u)===p?1:0,a[o++]=n-u*p;return u>0&&a.push(u),a}function d(t,e){return t.length>=e.length?g(t,e):g(e,t)}function m(t,r){var n,o,i=t.length,s=new Array(i),a=e;for(o=0;o<i;o++)n=t[o]-a+r,r=Math.floor(n/a),s[o]=n-r*a,r+=1;for(;r>0;)s[o++]=r%a,r=Math.floor(r/a);return s}function w(t,r){var n,o,i=t.length,s=r.length,a=new Array(i),u=0,p=e;for(n=0;n<s;n++)(o=t[n]-u-r[n])<0?(o+=p,u=1):u=0,a[n]=o;for(n=s;n<i;n++){if(!((o=t[n]-u)<0)){a[n++]=o;break}o+=p,a[n]=o}for(;n<i;n++)a[n]=t[n];return h(a),a}function b(t,r,n){var o,i,s=t.length,a=new Array(s),f=-r,l=e;for(o=0;o<s;o++)i=t[o]+f,f=Math.floor(i/l),i%=l,a[o]=i<0?i+l:i;return"number"==typeof(a=c(a))?(n&&(a=-a),new p(a)):new u(a,n)}function S(t,r){var n,o,i,s,a=t.length,u=r.length,p=v(a+u),f=e;for(i=0;i<a;++i){s=t[i];for(var l=0;l<u;++l)n=s*r[l]+p[i+l],o=Math.floor(n/f),p[i+l]=n-o*f,p[i+l+1]+=o}return h(p),p}function E(t,r){var n,o,i=t.length,s=new Array(i),a=e,u=0;for(o=0;o<i;o++)n=t[o]*r+u,u=Math.floor(n/a),s[o]=n-u*a;for(;u>0;)s[o++]=u%a,u=Math.floor(u/a);return s}function q(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function M(t,r,n){return new u(t<e?E(r,t):S(r,l(t)),n)}function A(t){var r,n,o,i,s=t.length,a=v(s+s),u=e;for(o=0;o<s;o++){i=t[o];for(var p=0;p<s;p++)r=i*t[p]+a[o+p],n=Math.floor(r/u),a[o+p]=r-n*u,a[o+p+1]+=n}return h(a),a}function P(t,r){var n,o,i,s,a=t.length,u=v(a),p=e;for(i=0,n=a-1;n>=0;--n)i=(s=i*p+t[n])-(o=y(s/r))*r,u[n]=0|o;return[u,0|i]}function x(t,r){var n,o,i=J(r),s=t.value,f=i.value;if(0===f)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new p(y(s/f)),new p(s%f)]:[a[0],t];if(i.isSmall){if(1===f)return[t,a[0]];if(-1==f)return[t.negate(),a[0]];var g=Math.abs(f);if(g<e){o=c((n=P(s,g))[0]);var d=n[1];return t.sign&&(d=-d),"number"==typeof o?(t.sign!==i.sign&&(o=-o),[new p(o),new p(d)]):[new u(o,t.sign!==i.sign),new p(d)]}f=l(g)}var m=O(s,f);if(-1===m)return[a[0],t];if(0===m)return[a[t.sign===i.sign?1:-1],a[0]];o=(n=s.length+f.length<=200?function(t,r){var n,o,i,s,a,u,p,f=t.length,l=r.length,h=e,y=v(r.length),g=r[l-1],d=Math.ceil(h/(2*g)),m=E(t,d),w=E(r,d);for(m.length<=f&&m.push(0),w.push(0),g=w[l-1],o=f-l;o>=0;o--){for(n=h-1,m[o+l]!==g&&(n=Math.floor((m[o+l]*h+m[o+l-1])/g)),i=0,s=0,u=w.length,a=0;a<u;a++)i+=n*w[a],p=Math.floor(i/h),s+=m[o+a]-(i-p*h),i=p,s<0?(m[o+a]=s+h,s=-1):(m[o+a]=s,s=0);for(;0!==s;){for(n-=1,i=0,a=0;a<u;a++)(i+=m[o+a]-h+w[a])<0?(m[o+a]=i+h,i=0):(m[o+a]=i,i=1);s+=i}y[o]=n}return m=P(m,d)[0],[c(y),c(m)]}(s,f):function(t,r){for(var n,o,i,s,a,u=t.length,p=r.length,f=[],l=[],v=e;u;)if(l.unshift(t[--u]),h(l),O(l,r)<0)f.push(0);else{i=l[(o=l.length)-1]*v+l[o-2],s=r[p-1]*v+r[p-2],o>p&&(i=(i+1)*v),n=Math.ceil(i/s);do{if(O(a=E(r,n),l)<=0)break;n--}while(n);f.push(n),l=w(l,a)}return f.reverse(),[c(f),c(l)]}(s,f))[0];var b=t.sign!==i.sign,S=n[1],q=t.sign;return"number"==typeof o?(b&&(o=-o),o=new p(o)):o=new u(o,b),"number"==typeof S?(q&&(S=-S),S=new p(S)):S=new u(S,q),[o,S]}function O(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function B(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(25)||void 0))}u.prototype=Object.create(a.prototype),p.prototype=Object.create(a.prototype),u.prototype.add=function(t){var e=J(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(m(r,Math.abs(n)),this.sign):new u(d(r,n),this.sign)},u.prototype.plus=u.prototype.add,p.prototype.add=function(t){var e=J(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(f(r+n))return new p(r+n);n=l(Math.abs(n))}return new u(m(n,Math.abs(r)),r<0)},p.prototype.plus=p.prototype.add,u.prototype.subtract=function(t){var e=J(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?b(r,Math.abs(n),this.sign):function(t,e,r){var n;return O(t,e)>=0?n=w(t,e):(n=w(e,t),r=!r),"number"==typeof(n=c(n))?(r&&(n=-n),new p(n)):new u(n,r)}(r,n,this.sign)},u.prototype.minus=u.prototype.subtract,p.prototype.subtract=function(t){var e=J(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new p(r-n):b(n,Math.abs(r),r>=0)},p.prototype.minus=p.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},p.prototype.negate=function(){var t=this.sign,e=new p(-this.value);return e.sign=!t,e},u.prototype.abs=function(){return new u(this.value,!1)},p.prototype.abs=function(){return new p(Math.abs(this.value))},u.prototype.multiply=function(t){var r,n,o,i=J(t),s=this.value,p=i.value,f=this.sign!==i.sign;if(i.isSmall){if(0===p)return a[0];if(1===p)return this;if(-1===p)return this.negate();if((r=Math.abs(p))<e)return new u(E(s,r),f);p=l(r)}return new u(-.012*(n=s.length)-.012*(o=p.length)+15e-6*n*o>0?function t(e,r){var n=Math.max(e.length,r.length);if(n<=30)return S(e,r);n=Math.ceil(n/2);var o=e.slice(n),i=e.slice(0,n),s=r.slice(n),a=r.slice(0,n),u=t(i,a),p=t(o,s),f=t(d(i,o),d(a,s)),l=d(d(u,q(w(w(f,u),p),n)),q(p,2*n));return h(l),l}(s,p):S(s,p),f)},u.prototype.times=u.prototype.multiply,p.prototype._multiplyBySmall=function(t){return f(t.value*this.value)?new p(t.value*this.value):M(Math.abs(t.value),l(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():M(Math.abs(t.value),this.value,this.sign!==t.sign)},p.prototype.multiply=function(t){return J(t)._multiplyBySmall(this)},p.prototype.times=p.prototype.multiply,u.prototype.square=function(){return new u(A(this.value),!1)},p.prototype.square=function(){var t=this.value*this.value;return f(t)?new p(t):new u(A(l(Math.abs(this.value))),!1)},u.prototype.divmod=function(t){var e=x(this,t);return{quotient:e[0],remainder:e[1]}},p.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return x(this,t)[0]},p.prototype.over=p.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return x(this,t)[1]},p.prototype.remainder=p.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,o=J(t),i=this.value,s=o.value;if(0===s)return a[1];if(0===i)return a[0];if(1===i)return a[1];if(-1===i)return o.isEven()?a[1]:a[-1];if(o.sign)return a[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&f(e=Math.pow(i,s)))return new p(y(e));for(r=this,n=a[1];!0&s&&(n=n.times(r),--s),0!==s;)s/=2,r=r.square();return n},p.prototype.pow=u.prototype.pow,u.prototype.modPow=function(t,e){if(t=J(t),(e=J(e)).isZero())throw new Error("Cannot take modPow with modulus 0");for(var r=a[1],n=this.mod(e);t.isPositive();){if(n.isZero())return a[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},p.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=J(t),r=this.value,n=e.value;return e.isSmall?1:O(r,n)},p.prototype.compareAbs=function(t){var e=J(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=J(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:O(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,p.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=J(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},p.prototype.compareTo=p.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},p.prototype.eq=p.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},p.prototype.neq=p.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},p.prototype.gt=p.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return this.compare(t)<0},p.prototype.lt=p.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},p.prototype.geq=p.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},p.prototype.leq=p.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return 0==(1&this.value[0])},p.prototype.isEven=function(){return 0==(1&this.value)},u.prototype.isOdd=function(){return 1==(1&this.value[0])},p.prototype.isOdd=function(){return 1==(1&this.value)},u.prototype.isPositive=function(){return!this.sign},p.prototype.isPositive=function(){return this.value>0},u.prototype.isNegative=function(){return this.sign},p.prototype.isNegative=function(){return this.value<0},u.prototype.isUnit=function(){return!1},p.prototype.isUnit=function(){return 1===Math.abs(this.value)},u.prototype.isZero=function(){return!1},p.prototype.isZero=function(){return 0===this.value},u.prototype.isDivisibleBy=function(t){var e=J(t),r=e.value;return 0!==r&&(1===r||(2===r?this.isEven():this.mod(e).equals(a[0])))},p.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(){var t=B(this);if(void 0!==t)return t;for(var e,r,o,i,s=this.abs(),u=s.prev(),p=[2,3,5,7,11,13,17,19],f=u;f.isEven();)f=f.divide(2);for(o=0;o<p.length;o++)if(!(i=n(p[o]).modPow(f,s)).equals(a[1])&&!i.equals(u)){for(r=!0,e=f;r&&e.lesser(u);e=e.multiply(2))(i=i.square().mod(s)).equals(u)&&(r=!1);if(r)return!1}return!0},p.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(t){var e=B(this);if(void 0!==e)return e;for(var r=this.abs(),o=void 0===t?5:t,i=0;i<o;i++)if(!n.randBetween(2,r.minus(2)).modPow(r.prev(),r).isUnit())return!1;return!0},p.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,r,o,i=n.zero,s=n.one,a=J(t),u=this.abs();!u.equals(n.zero);)e=a.divide(u),r=i,o=a,i=s,a=u,s=r.subtract(e.multiply(s)),u=o.subtract(e.multiply(u));if(!a.equals(1))throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===i.compare(0)&&(i=i.add(t)),this.isNegative()?i.negate():i},p.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?b(t,1,this.sign):new u(m(t,1),this.sign)},p.prototype.next=function(){var t=this.value;return t+1<o?new p(t+1):new u(i,!1)},u.prototype.prev=function(){var t=this.value;return this.sign?new u(m(t,1),!0):b(t,1,this.sign)},p.prototype.prev=function(){var t=this.value;return t-1>-o?new p(t-1):new u(i,!0)};for(var C=[1];C[C.length-1]<=e;)C.push(2*C[C.length-1]);var D=C.length,F=C[D-1];function N(t){return("number"==typeof t||"string"==typeof t)&&+Math.abs(t)<=e||t instanceof u&&t.value.length<=1}function k(t,e,r){e=J(e);for(var o=t.isNegative(),i=e.isNegative(),s=o?t.not():t,a=i?e.not():e,u=[],p=[],f=!1,l=!1;!f||!l;)s.isZero()?(f=!0,u.push(o?1:0)):o?u.push(s.isEven()?1:0):u.push(s.isEven()?0:1),a.isZero()?(l=!0,p.push(i?1:0)):i?p.push(a.isEven()?1:0):p.push(a.isEven()?0:1),s=s.over(2),a=a.over(2);for(var c=[],h=0;h<u.length;h++)c.push(r(u[h],p[h]));for(var v=n(c.pop()).negate().times(n(2).pow(c.length));c.length;)v=v.add(n(c.pop()).times(n(2).pow(c.length)));return v}u.prototype.shiftLeft=function(t){if(!N(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftRight(-t);for(var e=this;t>=D;)e=e.multiply(F),t-=D-1;return e.multiply(C[t])},p.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e;if(!N(t))throw new Error(String(t)+" is too large for shifting.");if((t=+t)<0)return this.shiftLeft(-t);for(var r=this;t>=D;){if(r.isZero())return r;r=(e=x(r,F))[1].isNegative()?e[0].prev():e[0],t-=D-1}return(e=x(r,C[t]))[1].isNegative()?e[0].prev():e[0]},p.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},p.prototype.not=u.prototype.not,u.prototype.and=function(t){return k(this,t,function(t,e){return t&e})},p.prototype.and=u.prototype.and,u.prototype.or=function(t){return k(this,t,function(t,e){return t|e})},p.prototype.or=u.prototype.or,u.prototype.xor=function(t){return k(this,t,function(t,e){return t^e})},p.prototype.xor=u.prototype.xor;var H=1<<30,I=(e&-e)*(e&-e)|H;function Z(t){var r=t.value,n="number"==typeof r?r|H:r[0]+r[1]*e|I;return n&-n}function j(t,e){return t=J(t),e=J(e),t.greater(e)?t:e}function R(t,e){return t=J(t),e=J(e),t.lesser(e)?t:e}function T(t,e){if(t=J(t).abs(),e=J(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,o=a[1];t.isEven()&&e.isEven();)r=Math.min(Z(t),Z(e)),t=t.divide(r),e=e.divide(r),o=o.multiply(r);for(;t.isEven();)t=t.divide(Z(t));do{for(;e.isEven();)e=e.divide(Z(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return o.isUnit()?t:t.multiply(o)}var U=function(t,e){var r=t.length;if(2<=e&&e<=36&&r<=s/Math.log(e))return new p(parseInt(t,e));e=J(e);var n,o=[],i="-"===t[0];for(n=i?1:0;n<t.length;n++){var a=t[n].toLowerCase(),u=a.charCodeAt(0);if(48<=u&&u<=57)o.push(J(a));else if(97<=u&&u<=122)o.push(J(a.charCodeAt(0)-87));else{if("<"!==a)throw new Error(a+" is not a valid character");var f=n;do{n++}while(">"!==t[n]);o.push(J(t.slice(f+1,n)))}}return L(o,e,i)};function L(t,e,r){var n,o=a[0],i=a[1];for(n=t.length-1;n>=0;n--)o=o.add(t[n].times(i)),i=i.times(e);return r?o.negate():o}function K(t){var e=t.value;return"number"==typeof e&&(e=[e]),1===e.length&&e[0]<=35?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e[0]):"<"+e+">"}function _(t,e){if((e=n(e)).isZero()){if(t.isZero())return"0";throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1))return t.isZero()?"0":t.isNegative()?new Array(1-t).join("10"):"1"+new Array(+t).join("01");var r="";if(t.isNegative()&&e.isPositive()&&(r="-",t=t.abs()),e.equals(1))return t.isZero()?"0":r+new Array(+t+1).join(1);for(var o,i=[],s=t;s.isNegative()||s.compareAbs(e)>=0;){o=s.divmod(e),s=o.quotient;var a=o.remainder;a.isNegative()&&(a=e.minus(a).abs(),s=s.next()),i.push(K(a))}return i.push(K(s)),r+i.reverse().join("")}function z(t){if(f(+t)){var e=+t;if(e===y(e))return new p(e);throw"Invalid integer: "+t}var n="-"===t[0];n&&(t=t.slice(1));var o=t.split(/e/i);if(o.length>2)throw new Error("Invalid integer: "+o.join("e"));if(2===o.length){var i=o[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==y(i)||!f(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var s=o[0],a=s.indexOf(".");if(a>=0&&(i-=s.length-a-1,s=s.slice(0,a)+s.slice(a+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=s+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);for(var l=[],c=t.length,v=r,g=c-v;c>0;)l.push(+t.slice(g,c)),(g-=v)<0&&(g=0),c-=v;return h(l),new u(l,n)}function J(t){return"number"==typeof t?function(t){if(f(t)){if(t!==y(t))throw new Error(t+" is not an integer.");return new p(t)}return z(t.toString())}(t):"string"==typeof t?z(t):t}u.prototype.toString=function(t){if(void 0===t&&(t=10),10!==t)return _(this,t);for(var e,r=this.value,n=r.length,o=String(r[--n]);--n>=0;)e=String(r[n]),o+="0000000".slice(e.length)+e;return(this.sign?"-":"")+o},p.prototype.toString=function(t){return void 0===t&&(t=10),10!=t?_(this,t):String(this.value)},u.prototype.valueOf=function(){return+this.toString()},u.prototype.toJSNumber=u.prototype.valueOf,p.prototype.valueOf=function(){return this.value},p.prototype.toJSNumber=p.prototype.valueOf;for(var $=0;$<1e3;$++)a[$]=new p($),$>0&&(a[-$]=new p(-$));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=j,a.min=R,a.gcd=T,a.lcm=function(t,e){return t=J(t).abs(),e=J(e).abs(),t.divide(T(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof u||t instanceof p},a.randBetween=function(t,r){var n=R(t=J(t),r=J(r)),o=j(t,r).subtract(n);if(o.isSmall)return n.add(Math.round(Math.random()*o));for(var i=[],s=!0,a=o.value.length-1;a>=0;a--){var f=s?o.value[a]:e,l=y(Math.random()*f);i.unshift(l),l<f&&(s=!1)}return i=c(i),n.add("number"==typeof i?new p(i):new u(i,!1))},a.fromArray=function(t,e,r){return L(t.map(J),J(e||10),r)},a}();void 0!==e&&e.hasOwnProperty("exports")&&(e.exports=n),"function"==typeof define&&define.amd&&define("big-integer",[],function(){return n})},{}],3:[function(t,e,r){e.exports={stringToArrayBuffer:function(t){const e=unescape(encodeURIComponent(t)).split(""),r=[];for(let t=0;t<e.length;t+=1)r.push(e[t].charCodeAt(0));return new Uint8Array(r)},arrayBufferToHex:function(t){const e=new Uint8Array(t);let r="";for(let t=0;t<e.byteLength;t+=1)r+=e[t].toString(16).padStart(2,"0");return r},getAlgorithm:function(t){return{sha1:"SHA-1","sha-1":"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha512:"SHA-512","sha-512":"SHA-512"}[t.toLowerCase()]}}},{}],4:[function(t,e,r){const n=t("./pbkdf2");function o(t,e){const{site:r,login:o,options:i,crypto:s}=t,{counter:a}=i||{counter:1},u=r+o+a.toString(16),{iterations:p,keylen:f,digest:l}=s||{iterations:1e5,keylen:32,digest:"sha256"};return n(e,u,p,f,l)}e.exports={isSupported:function(){try{return o({site:"lesspass.com",login:"♥",options:{uppercase:!0,lowercase:!0,digits:!0,symbols:!0,length:16,counter:1},crypto:{method:"pbkdf2",iterations:1,keylen:32,digest:"sha256"}},"tHis is a g00d! password").then(t=>"e99e20abab609cc4564ef137acb540de20d9b92dcc5cda58f78ba431444ef2da"===t?Promise.resolve(!0):Promise.resolve(!1))}catch(t){return Promise.resolve(!1)}},calcEntropy:o}},{"./pbkdf2":5}],5:[function(t,e,r){const{stringToArrayBuffer:n,arrayBufferToHex:o,getAlgorithm:i}=t("lesspass-crypto");e.exports=function(t,e,r,s,a){return window.crypto.subtle.importKey("raw",n(t),"PBKDF2",!1,["deriveKey"]).then(t=>{const o={name:"PBKDF2",salt:n(e),iterations:r,hash:i(a)};return window.crypto.subtle.deriveKey(o,t,{name:"AES-CTR",length:8*s},!0,["encrypt","decrypt"])}).then(t=>window.crypto.subtle.exportKey("raw",t).then(t=>o(t)))}},{"lesspass-crypto":3}],6:[function(t,e,r){function n(t){const e=["#000000","#074750","#009191","#FF6CB6","#FFB5DA","#490092","#006CDB","#B66DFF","#6DB5FE","#B5DAFE","#920000","#924900","#DB6D00","#24FE23"];return e[parseInt(t,16)%e.length]}function o(t){const e=["fa-hashtag","fa-heart","fa-hotel","fa-university","fa-plug","fa-ambulance","fa-bus","fa-car","fa-plane","fa-rocket","fa-ship","fa-subway","fa-truck","fa-jpy","fa-eur","fa-btc","fa-usd","fa-gbp","fa-archive","fa-area-chart","fa-bed","fa-beer","fa-bell","fa-binoculars","fa-birthday-cake","fa-bomb","fa-briefcase","fa-bug","fa-camera","fa-cart-plus","fa-certificate","fa-coffee","fa-cloud","fa-coffee","fa-comment","fa-cube","fa-cutlery","fa-database","fa-diamond","fa-exclamation-circle","fa-eye","fa-flag","fa-flask","fa-futbol-o","fa-gamepad","fa-graduation-cap"];return e[parseInt(t,16)%e.length]}e.exports=function(t){const e=[],r=t.substring(0,6);e.push({color:n(r),icon:o(r)});const i=t.substring(6,12);e.push({color:n(i),icon:o(i)});const s=t.substring(12,18);return e.push({color:n(s),icon:o(s)}),e}},{}],7:[function(t,e,r){const{stringToArrayBuffer:n,arrayBufferToHex:o,getAlgorithm:i}=t("lesspass-crypto");e.exports=function(t,e,r){return window.crypto.subtle.importKey("raw",n(e),{name:"HMAC",hash:{name:i(t)}},!0,["sign","verify"]).then(t=>window.crypto.subtle.sign({name:"HMAC"},t,n(r||"")).then(t=>o(t)))}},{"lesspass-crypto":3}],8:[function(t,e,r){const n=t("./fingerprint"),o=t("./hmac");e.exports={createFingerprint:n,createHmac:o}},{"./fingerprint":6,"./hmac":7}],9:[function(t,e,r){const{consumeEntropy:n}=t("./entropy"),o={lowercase:"abcdefghijklmnopqrstuvwxyz",uppercase:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",digits:"0123456789",symbols:"!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~"};e.exports={getSetOfCharacters:function(t){if(void 0===t)return o.lowercase+o.uppercase+o.digits+o.symbols;let e="";return t.forEach(t=>{e+=o[t]}),e},getOneCharPerRule:function(t,e){let r="",i=t;return e.forEach(t=>{const e=n("",i,o[t],1);r+=e.value,i=e.entropy}),{value:r,entropy:i}},insertStringPseudoRandomly:function(t,e,r){let n=e,o=t;for(let t=0;t<r.length;t+=1){const e=n.divmod(o.length);o=o.slice(0,e.remainder)+r[t]+o.slice(e.remainder),n=e.quotient}return o},getRules:function(t){return["lowercase","uppercase","digits","symbols"].filter(e=>t[e])},characterSubsets:o}},{"./entropy":10}],10:[function(t,e,r){e.exports={consumeEntropy:function t(e,r,n,o){let i=e;if(i.length>=o)return{value:i,entropy:r};const s=r.divmod(n.length);return t(i+=n[s.remainder],s.quotient,n,o)}}},{}],11:[function(t,e,r){const n=t("big-integer"),o=t("./chars"),{consumeEntropy:i}=t("./entropy");e.exports={renderPassword:function(t,e){const r=o.getRules(e),s=o.getSetOfCharacters(r),a=i("",n(t,16),s,e.length-r.length),u=o.getOneCharPerRule(a.entropy,r);return o.insertStringPseudoRandomly(a.value,u.entropy,u.value)}}},{"./chars":9,"./entropy":10,"big-integer":2}],12:[function(t,e,r){const n=t("lesspass-fingerprint"),o=t("lesspass-entropy"),i=t("lesspass-render-password");e.exports={generatePassword:function(t,e,r,n){const s=void 0===r;s||console.warn("LessPass generatePassword API changed. Please update your code. Old API will be removed on version 10.");const a=s?t.site:t,u=s?t.login:e,p=s?e:r,f=s?t.length:n.length,l=s?t.counter:n.counter,c=s?t.lowercase:n.lowercase,h=s?t.uppercase:n.uppercase,v=s?t.digits:n.numbers,y=s?t.symbols:n.symbols;return o.calcEntropy({site:a,login:u,options:{counter:l}},p).then(t=>{const e={length:f,lowercase:c,uppercase:h,digits:v,symbols:y},r=i.renderPassword(t,e);return Promise.resolve(r)})},createFingerprint:function(t){return n.createHmac("sha256",t).then(t=>{const e=n.createFingerprint(t);return Promise.resolve(e)})}}},{"lesspass-entropy":4,"lesspass-fingerprint":8,"lesspass-render-password":11}]},{},[1]);</script>
  <!-- Local JS controller code. -->
  <script>window.generatePassword=function(){const e=document.getElementById("lp-form"),n=new FormData(e),t={length:n.get("length"),counter:n.get("number")};return Array.from(n.getAll("rules[]")).forEach(e=>t[e]=!0),lesspass.generatePassword(n.get("context"),n.get("identifier"),n.get("masterpassword"),t).then(n=>(e.elements.result.value=n,Promise.resolve({value:n,form:e})))},window.generateAndCopyPassword=function(){generatePassword().then(e=>{copyPasswordToClipboard(e.form.elements.result)})},window.clipboardAndClear=function(){const e=document.getElementById("lp-form");copyPasswordToClipboard(e.elements.result),e.reset()},window.clearForm=function(){document.getElementById("lp-form").reset()},window.copyPasswordToClipboard=function(e){const n=document.createRange(),t=window.getSelection();e.select(),n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n),e.readOnly=!1,e.contentEditable=!0,e.setSelectionRange(0,256),e.readOnly=!0,e.contentEditable=!1,document.execCommand("copy"),e.value="(in clipboard)"},window.updateChecksum=function(){const e=document.getElementById("lp-form"),n=new FormData(e),t=e.getElementsByClassName("lp-mp-render")[0];lesspass.createFingerprint(n.get("masterpassword")).then(e=>{t.innerHTML="",e.forEach(e=>{const n=document.createElement("span");n.innerHTML=e.icon+" ",n.style.color=e.color,t.appendChild(n)})})};</script>
</html>
